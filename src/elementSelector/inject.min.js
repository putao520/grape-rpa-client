(()=>{"use strict";var e,t,n=function(){var e=document.createElement("style");return e.textContent=`
.gsc-xh-highlight {
    background-color: rgb(255, 245, 157) !important;
}
.gsc-radio-style input:checked + label {
    background: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB2ZXJzaW9uPSIxLjEiIGlkPSJpY29fY2hlY2tvbiIgeD0iMHB4IiB5PSIwcHgiIHZpZXdCb3g9IjAgMCA0MiA0MiIgc3R5bGU9ImVuYWJsZS1iYWNrZ3JvdW5kOm5ldyAwIDAgNDIgNDI7IiB4bWw6c3BhY2U9InByZXNlcnZlIj4NCjxzdHlsZSB0eXBlPSJ0ZXh0L2NzcyI+DQoJLnN0MHtmaWxsLXJ1bGU6ZXZlbm9kZDtjbGlwLXJ1bGU6ZXZlbm9kZDtmaWxsOiMwMEE0RkY7fQ0KCS5zdDF7ZmlsbDojRkZGRkZGO30NCjwvc3R5bGU+DQo8Zz4NCgk8Zz4NCgkJPHBvbHlnb24gY2xhc3M9InN0MCIgcG9pbnRzPSI0Miw0MiA0MiwwLjUgMC41LDQyICAgIi8+DQoJPC9nPg0KPC9nPg0KPHBhdGggY2xhc3M9InN0MSIgZD0iTTE5LjQsMjYuOWw4LjUsOC41TDI1LDM4LjJsLTguNS04LjVMMTkuNCwyNi45eiBNMzYuNCwyMS4ybDIuOCwyLjhMMjUuMSwzOC4ybC0yLjgtMi44TDM2LjQsMjEuMnoiLz4NCjwvc3ZnPg==) no-repeat right bottom;
    border: 1px solid #00a4ff;
    background-size: 21px 21px;
    color: #00a4ff;
}
.gsc-radio-style label {
    border: 1px solid #CCC;
    color: #666;
    padding: 2px 10px 2px 5px;
    line-height: 28px;
    min-width: 80px;
    text-align: center;
    float: left;
    margin: 2px;
    border-radius: 4px;
}
.gsc-modal {
    position: fixed;
    min-width: 100px;
    background-color: #fff;
    color: #444;
    bottom: 0px;
    box-shadow: 0 3px 8px 1px rgb(0 0 0 / 20%);
    border-radius: 3.5px;
    display: none;
    z-index: 100002;
}
.gsc-modal .gsc-modal-content {
    position: relative;
    padding: 10px 25px;
    line-height: 24px;
    word-break: break-all;
    overflow: hidden;
    font-size: 14px;
    overflow-x: hidden;
    overflow-y: auto;
    box-sizing: border-box;
    -webkit-box-sizing: border-box;
    -moz-box-sizing: border-box;
}
.gsc-modal .gsc-modal-content h4 {
    display: block;
    margin-block-start: 1.33em;
    margin-block-end: 1.33em;
    margin-inline-start: 0px;
    margin-inline-end: 0px;
    font-weight: bold;
}
.gsc-modal-close {
    display: inline-block;
    width: 14px;
    height: 1px;
    background: #6e6e6e;
    transform: rotate(45deg);
    position: absolute;
    right: 18px;
    top: 22px;
}
.gsc-modal-close::before {
    content: '';
    display: block;
    width: 14px;
    height: 1px;
    background: #6e6e6e;
    transform: rotate(-90deg);
}
.gsc-modal-close::after {
    content: ' ';
    width: 16px;
    height: 16px;
    display: block;
    cursor: pointer;
    transform: rotate(45deg);
    position: absolute;
    right: -1px;
    top: -8px;
}
.gsc-modal.gsc-modal-box {
}
.gsc-modal.gsc-modal-box .gsc-modal-buttons {
    padding: 8px 25px;
    margin-bottom: 12px;
	text-align: center;
}
.gsc-modal.gsc-modal-box .gsc-modal-buttons .gsc-button {
    display: inline-block;
    margin-right: 12px;
    border-radius: 3.5px;
    color: #fff;
    background-color: #1976d2;
    padding: 6px 16px;
    font-size: 14px;
    cursor: pointer;
}
`,document.documentElement.appendChild(e),e};const o=e=>{d(e.target)},i=new class{inFn;outFn;delay;currentEventTime;currentTimer;waitUninstallState;constructor(e,t){this.inFn=e,this.outFn=t,this.delay=1e3,this.currentEventTime=0,this.currentTimer=null,this.waitUninstallState=!1}install(){0==this.waitUninstallState&&this.inFn(),this.currentTimer&&(clearTimeout(this.currentTimer),this.currentTimer=null,this.waitUninstallState=!1),this.currentEventTime=Date.parse(new Date)}uninstall(){Date.parse(new Date)-this.currentEventTime>this.delay?this.outFn():(this.currentTimer=setTimeout(()=>{this.outFn(),this.waitUninstallState=!1},this.delay),this.waitUninstallState=!0)}setDelay(e){this.delay=1e3*e}}(function(){var e=document.querySelectorAll("*");for(var t of e)t.id&&t.id.startsWith("grape_")||(t.addEventListener("mouseover",o),t.style.zIndex>c&&(c=t.style.zIndex))},function(){var e=document.querySelectorAll("*");for(var t of e)t.id&&t.id.startsWith("grape_")||t.removeEventListener("mouseover",o)}),l="grape_frame_id_"+Math.floor(100*Math.random());let r=null;let a=null;function d(e){var t,n;e&&(t=e.getBoundingClientRect(),r&&((n=r.style).top=t.top+"px",n.left=t.left+"px",n.width=t.width+"px",n.height=t.height+"px",n.display="block"),a&&a.classList.remove("gsc-xh-highlight"),a=e)}let s=!1;let c=0;let p=null;function u(e,t){window.rpa&&window.rpa.sendIpcMessage({op:e,data:t})}function g(e,t){var n=[],o=document.evaluate(e,t||document,null,XPathResult.ORDERED_NODE_SNAPSHOT_TYPE,null);for(let e=0,t=o.snapshotLength;e<t;++e)n.push(o.snapshotItem(e));return n}const h="grape_model_id_"+Math.floor(100*Math.random()),m=["td","tr","th","tt","dl","dd","dt","ol","li","ul"],x=e=>{"Control"===e.key&&w&&(w.style.display="none")},b=e=>{"Control"===e.key&&w&&(w.style.display="block")};const f=e=>{for(var t of N)t.classList.remove("gsc-xh-highlight");I&&I(L,e),w&&(w.remove(),w=null),document.removeEventListener("keydown",x),document.removeEventListener("keyup",b)};function v(e){return e.slice(1,e.length-1)}let y=[];let w=null;function E(){(w=document.createElement("div")).setAttribute("id",h),w.classList.add("gsc-modal"),w.classList.add("gsc-modal-box");var e=document.createElement("div"),t=(e.classList.add("gsc-modal-content"),e.classList.add("gsc-radio-style"),document.createElement("h4")),t=(t.innerText="批量层级管理",e.appendChild(t),document.createElement("p")),n=(e.appendChild(t),document.createElement("a")),o=(n.classList.add("gsc-modal-close"),n.addEventListener("click",e=>{f(!1)}),document.createElement("div")),i=(o.classList.add("gsc-modal-buttons"),document.createElement("a")),l=(i.classList.add("gsc-button"),i.classList.add("primary"),i.innerText="确定",i.addEventListener("click",e=>{f(!0)}),t),r=(k=[],"grape_option_id_"+Math.floor(100*Math.random())),a=D.split("/");for(let e=0;e<y.length;e++){var d=y[e],s=document.createElement("input"),c=r+"_"+e,p=(s.setAttribute("type","checkbox"),s.setAttribute("id",c),s.setAttribute("name","level"),s.setAttribute("value",d),s.setAttribute("style","display: none;"),s.addEventListener("change",e=>{C(),M()}),a[d].slice(0,a[d].indexOf("["))),d=(0<=a[d].indexOf("[*]")&&(s.checked=!0),k.push(s),l.appendChild(s),document.createElement("label"));d.setAttribute("for",c),d.innerText="第 "+(e+1)+" 级<"+p+">",l.appendChild(d)}w.appendChild(e),w.appendChild(n),o.appendChild(i),w.appendChild(o),document.body.appendChild(w)}let k=[];let L;function C(){var e,t=D.split("/"),n=L.split("/");for(e of k){var o,i=parseInt(e.value);e.checked?(o=t[i],n[i]=o.replace(/(\[.[0-9]*\])/,"[*]")):n[i]=t[i]}L=n.join("/")}function M(){for(var e of N)e.classList.remove("gsc-xh-highlight");for(var t of N=g(L))t.classList.add("gsc-xh-highlight")}let N=[],I,D;function T(e,t){f(!1),D=e,L=function(t){var n=t.split("/");for(let e=0;e<n.length;e++)if(0<=n[e].indexOf("[*]"))return t;for(let e=n.length-1;0<=e;e--){var o=n[e],i=o.slice(0,o.indexOf("["));if(0===m.indexOf(i)){i=o.match(/(\[.[0-9]*\])/g);if(i&&0<i.length)for(var l of i){l=v(l);if(!isNaN(parseInt(l)))return n[e]=o.replace(/(\[.[0-9]*\])/,"[*]"),n.join("/")}}}for(let e=n.length-1;0<=e;e--){var r=n[e],a=r.match(/(\[.[0-9]*\])/g);if(a&&0<a.length)for(var d of a){d=v(d);if(!isNaN(parseInt(d)))return n[e]=r.replace(/(\[.[0-9]*\])/,"[*]"),n.join("/")}}return t}(e),I=t,y=[];var n=D.split("/");for(let e=0;e<n.length;e++){var o=n[e].match(/(\[.[0-9]*\])/g);if(o&&0<o.length)for(var i of o){i=v(i);if(!isNaN(parseInt(i))||"*"===i){y.push(e);break}}}y.length,E(),C(),w&&(w.style.display="block",e=w.getBoundingClientRect(),w.style.left=(document.documentElement.clientWidth-e.width)/2+"px",M()),document.addEventListener("keydown",x),document.addEventListener("keyup",b)}const S="grape_tips_id_"+Math.floor(100*Math.random());let _;const z=e=>{u("update_selector",{xpath:e,payload:function(e){var t=g(e),n={},o={};for(let e=0;e<t.length;e++){var i=getComputedStyle(t[e]);for(let e=0;e<i.length;e++){var l=i[e];n[l]=i[l]}var r=t[e].attributes;for(let e=0;e<r.length;e++){var a=r[e].name;o[a]=r[a].value}d=p=c=s=void 0;var d,s=o,c=t[e];for(d in c){var p=c[d];"string"!=typeof p&&"number"!=typeof p&&"boolean"!=typeof p||(s[d]=p)}}return{css:n,props:o}}(e)})};let j=!1;const Z=(e,t)=>{t&&z(e)};e="ctrl+鼠标左键,获取元素",(_=document.createElement("div")).setAttribute("id",S),_.setAttribute("style","top: 0px; right: 0px; opacity: 0.6; z-index:999999; position: fixed; background: black; color: white; padding: 10px; border-radius: 5px;"),_.addEventListener("mouseover",e=>{"0px"===_.style.right?(_.style.right="",_.style.left="0px"):"0px"===_.style.left&&(_.style.left="",_.style.right="0px")}),_.innerText=e,document.body.appendChild(_),n();{document.addEventListener("keydown",e=>{"Control"!==e.key||s||(s=!0,(r=document.createElement("div")).setAttribute("id",l),r.setAttribute("style","opacity: 0.6; background: black; pointer-events: none; position: fixed; border: 2px solid red; z-index:"+(c+1e4)+";"),document.body.appendChild(r),d(n),i.install())}),document.addEventListener("keyup",e=>{"Control"===e.key&&(i.uninstall(),r&&(r.remove(),r=null),s=!1)});let n=null;document.addEventListener("mousemove",e=>{var t=e.clientX,e=e.clientY;n=document.elementFromPoint(t,e)}),document.addEventListener("mousedown",e=>{0===e.button&&window.event.ctrlKey&&a&&(p&&p(function(e){let o=e;for(var i=[];o&&o.nodeType===Node.ELEMENT_NODE;){let e=0,t=!1,n=o.previousSibling;for(;n;)n.nodeType!==Node.DOCUMENT_TYPE_NODE&&n.nodeName===o.nodeName&&e++,n=n.previousSibling;for(n=o.nextSibling;n;){if(n.nodeName===o.nodeName){t=!0;break}n=n.nextSibling}var l=o.prefix?o.prefix+":":"",r=e||t?`[${e+1}]`:"";i.push(l+o.localName+r),o=o.parentNode}return i.length?"/"+i.reverse().join("/"):""}(a)),r)&&(r.style.pointerEvents="auto")}),document.addEventListener("mouseup",e=>{0===e.button&&r&&(r.style.pointerEvents="none")})}p=e=>{console.log("xpath: ",e),j?T(e,Z):z(e)},t=(e,t)=>{"init_selector"===e&&t&&(j=t.batchMode,t.xpath)&&(j?T(t.xpath,(e,t)=>{t&&z(e)}):(d(function(e,t){try{return document.evaluate(e,t||document,null,XPathResult.FIRST_ORDERED_NODE_TYPE,null).singleNodeValue}catch(e){return console.log(e),null}}(t.xpath)),a.classList.add("gsc-xh-highlight")))},window.rpa&&window.rpa.onIpcMessage(e=>{t(e.op,e.data)}),u("load_complete",{})})();