const nameTypeIndex = {};
const nameStore = {};

function incTypeIndex(type){
    if( nameTypeIndex[type] === undefined ){
        nameTypeIndex[type] = 0
    }
    nameTypeIndex[type]++
    return nameTypeIndex[type]
}
function getNameStore(type){
    if( nameStore[type] === undefined){
        nameStore[type] = {}
    }
    return nameStore[type]
}

function addNameStore(type, name){
    if( typeof name === 'string' && name.length > 0){
        getNameStore(type)[name] = true
    }
}

function IsInNameStore(type, name){
    return getNameStore(type)[name]
}

// 获得分类可用变量名
function getNamedVariable(type) {
    let name = ''
    do{
        name = type + "_" + incTypeIndex(type)
    }while(IsInNameStore(type, name));
    addNameStore(type, name)
    return name
}

function InitNamed(nodeId, val, i18nName){
    const label = RED._("node-red:" + i18nName)
    if( val === ''){
        $(nodeId).val(getNamedVariable(label))
    } else {
        addNameStore(label, val)
    }
}
